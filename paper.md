---
title: 'BrkRaw: Comprehensive tool for accessing Bruker PV dataset'
tags:
  - Preclinical MRI converter
  - Bruker
  - Python API
  - Command-line tool
  - BIDS
  - cross-platform
authors:
  - name: Sung-Ho Lee
    orcid: 0000-0001-5292-0747
    affiliation: "1, 2, 3"
  - name: Woomi Ban
    affiliation: "1, 3"
  - name: Yen-Yu Ian Shih
    orcid: 0000-0001-6529-911X
    affiliation: "1, 2, 3"
affiliations:
 - name: Center for Animal MRI, University of North Carolina at Chapel Hill
   index: 1
 - name: Department of Neurology, University of North Carolina at Chapel Hill
   index: 2
 - name: Biomedical Research Imaging Center(BRIC), University of North Carolina at Chapel Hill 
   index: 3
date: 22 April 2020
bibliography: paper.bib
---

# Summary
Accessing Magnetic Resonance Imaging (MRI) results often requires raw data conversion from 
vendor-specific format to various analysis-software compatible formats, among which DICOM has 
been commonly used. The DICOM format, however, includes a variety of metadata and patient 
information that is not always needed in the preclinical animal MRI research. 
The complexity of DICOM data structure also affects the efficiency of many data analysis pipelines. 
For this reason, image data formats with more efficient structure capable of encompassing 
spatial and temporal in a single file, such as NifTi or Analyze, are becoming 
the new standard of choice in many imaging research studies. An efficient, user friendly open source software 
to covert animal MRI raw data into NifTi or Analyze is needed. 

To address this, researchers had developed raw data converters for Bruker Biospin – the vendor 
currently leading the animal MRI market [@Brett:2002; @Ferraris:2017; @Chavarrias:2017; @Rorden:2018]. 
These converters allow bypassing the intermediate DICOM conversion step and can convert 
Bruker ParaVision MRI raw data into NifTi or Analyze. While these converters significantly 
improve analysis workflow, they do not provide the features needed to enhance direct data accessibility 
without conversion. Immediate data accessibility could enhance the efficiency of workflow further 
for developing open-source research tools for automation, visualization, and machine learning applications, 
which require the information deeply embedded in vendor-specific file format.

Here we disseminate the 'BrkRaw' python module to improve Bruker ParaVision MRI raw data conversion workflow 
with direct accessibility. Since this converter is a medical imaging front-line tool, 
the command-line tool for data management, a graphic user interface, and python API were developed 
to accommodate various user types, including MRI system operator, physicist/sequence developer, 
application scientist, and data scientist. We also managed the metadata tailored for animal research 
and provide tools to help organize the data structure into a shareable format guided by the open science community 
for pursuing reproducible science [@Gorgolewski:2016].
The python module disseminated herein was designed not only can be used for as a NifTi converter, 
but also to offer command-line tools and python API for previewing, organizing and archiving data, 
parsing metadata, and accessing data as users’ convenient object type (nibabel[@Brett:2020] or SimpleITK[@Lowekamp:2013]) 
without extra conversion steps. The module also provides direct access to a compressed ZIP data format 
to enables access to archived data without an extraction process.

This module has been actively utilizing as a front-line tool in the Center for Animal MRI (CAMRI) 
at the University of North Carolina at Chapel Hill.
We expect this tool to benefit other animal imaging research units and should reduce 
burden on handling and management of Bruker raw datasets and further data organization 
to pursue reproducible science. The future will be developing python-based acute quality control 
and realtime fMRI data analysis tools.

# Figures
![Python API](imgs/brkraw_python.png)
**Figure 1.** The example usage of python API.
The python API provides a print function to access brief summary of internal image data (A), 
and the data can be loaded into the python object compatible with broad range of 
open-source data analysis using the image handlers provided from nibabel or SimpleITK (B) 
or a numpy multi-dimensional array (C).


![BIDS conversion](imgs/brkraw_bids_conv.png)
**Figure 2.** The usage of the command-line tool 'brkraw' for BIDS data organization. 
The ready-to-share BIDS dataset can be generated easily by filling out the template files 
generated by the single command (left) followed by running the conversion (right).


![Data management](imgs/brk_backup.png)
**Figure 3.** brk-backup script utilizing the Python API to immediately access both raw data and archived data 
to parse the metadata for data management. This is one of the good application examples of BrkRaw python API.


![brkraw GUI](imgs/brkraw_gui.png)
**Figure 4.** A graphical user interface (GUI) for preview image and metadata.
 The another application example of Python API. The GUI is useful when the quick preview of the image is required. 
 It prints out subject info and scan parameters, and the slice axis also can be changed to look at 
 the image with different view planes in case of a multi-slice image.

# Acknowledgements

We thank to the staff and colleagues in the Center for Animal MRI (CAMRI) 
at the University of North Carolina at Chapel Hill for the testing and providing helpful 
feedback. Especially thanks to Ms. Tzu-Wen Wang for the test the data management tools and 
Ms. Alicia M. Stevans for the help of critical reading of the manuscript.
This work was supported by NIH (Grant No: RF1MH117053, R01MH111429, and R01NS091236).

# References